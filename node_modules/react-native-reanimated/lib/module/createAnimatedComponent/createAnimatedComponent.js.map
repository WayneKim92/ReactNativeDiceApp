{"version":3,"names":["React","findNodeHandle","Platform","StyleSheet","WorkletEventHandler","setAndForwardRef","invariant","adaptViewConfig","RNRenderer","configureLayoutAnimations","enableLayoutAnimations","startMapper","stopMapper","isJest","isChromeDebugger","shouldBeUseWeb","isWeb","initialUpdaterRun","SharedTransition","LayoutAnimationType","makeViewDescriptorsSet","getShadowNodeWrapperFromRef","updateProps","NativeReanimatedModule","isSharedValue","removeFromPropsRegistry","JSPropUpdater","getReduceMotionFromConfig","maybeBuild","flattenArray","has","IS_WEB","dummyListener","onlyAnimatedStyles","styles","filter","style","viewDescriptors","isSameAnimatedStyle","style1","style2","viewsRef","isSameAnimatedProps","isInlineStyleTransform","transform","some","t","hasInlineStyles","Object","keys","key","styleValue","extractSharedValuesMapFromProps","props","inlineProps","value","forEach","entries","inlinePropsHasChanged","styles1","styles2","length","getInlinePropsUpdate","update","map","createAnimatedComponent","Component","options","prototype","isReactComponent","name","AnimatedComponent","constructor","_defineProperty","getForwardedRef","forwardedRef","setLocalRef","ref","tag","layout","entering","exiting","sharedTransitionTag","LAYOUT","undefined","displayName","_this$props","ENTERING","reduceMotionInExiting","getReduceMotion","_this$props2","EXITING","sharedElementTransition","sharedTransitionStyle","reduceMotionInTransition","registerTransition","_sharedElementTransition","_component","animatedStyle","componentWillUnmount","_this$_sharedElementT","_detachNativeEvents","_JSPropUpdater","removeOnJSPropsChangeListener","_detachStyles","_detachInlineProps","unregisterTransition","_viewTag","componentDidMount","_attachNativeEvents","addOnJSPropsChangeListener","_attachAnimatedStyles","_attachInlineProps","_getEventViewRef","_this$_component","_getScrollableNode","_ref","getScrollableNode","call","node","viewTag","prop","current","setNativeProps","registerForEvents","unregisterFromEvents","_styles","remove","_this$props$animatedP","animatedProps","global","_IS_FABRIC","_reattachNativeEvents","prevProps","reattachNeeded","_updateFromNative","_this$_component2","_this$_component2$set","_getViewInfo","_this$_component3","_getAnimatableRef","_ref2","viewName","shadowNodeWrapper","viewConfig","component","getAnimatableRef","_hostInstance$viewCon","hostInstance","findHostInstance_DEPRECATED","Error","_nativeTag","uiViewClassName","_this$props$animatedP2","_this$props$animatedP3","prevStyles","prevAnimatedProps","_animatedProps","hasReanimated2Props","hasOneSameStyle","prevStyle","isPresent","add","initial","newInlineProps","hasChanged","_inlineProps","_inlinePropsViewDescriptors","sharableViewDescriptors","maybeViewRef","native","items","Set","updaterFunction","_inlinePropsMapperId","values","componentDidUpdate","_filterNonAnimatedProps","inputProps","styleProp","processedStyle","_isFirstRender","initialStyle","updater","newStyle","flatten","animatedProp","_animatedProp$initial","_animatedProp$viewsRe","eventNames","eventName","listeners","render","platformProps","select","web","default","collapsable","createElement","_extends","_setComponentRef","forwardRef"],"sources":["createAnimatedComponent.tsx"],"sourcesContent":["import type {\n  Component,\n  ComponentClass,\n  ComponentType,\n  FunctionComponent,\n  MutableRefObject,\n  Ref,\n} from 'react';\nimport React from 'react';\nimport { findNodeHandle, Platform, StyleSheet } from 'react-native';\nimport WorkletEventHandler from '../reanimated2/WorkletEventHandler';\nimport setAndForwardRef from './setAndForwardRef';\nimport '../reanimated2/layoutReanimation/animationsManager';\nimport invariant from 'invariant';\nimport { adaptViewConfig } from '../ConfigHelper';\nimport { RNRenderer } from '../reanimated2/platform-specific/RNRenderer';\nimport {\n  configureLayoutAnimations,\n  enableLayoutAnimations,\n  startMapper,\n  stopMapper,\n} from '../reanimated2/core';\nimport {\n  isJest,\n  isChromeDebugger,\n  shouldBeUseWeb,\n  isWeb,\n} from '../reanimated2/PlatformChecker';\nimport { initialUpdaterRun } from '../reanimated2/animation';\nimport {\n  SharedTransition,\n  LayoutAnimationType,\n} from '../reanimated2/layoutReanimation';\nimport type {\n  SharedValue,\n  StyleProps,\n  ShadowNodeWrapper,\n} from '../reanimated2/commonTypes';\nimport type {\n  ViewDescriptorsSet,\n  ViewRefSet,\n} from '../reanimated2/ViewDescriptorsSet';\nimport { makeViewDescriptorsSet } from '../reanimated2/ViewDescriptorsSet';\nimport { getShadowNodeWrapperFromRef } from '../reanimated2/fabricUtils';\nimport updateProps from '../reanimated2/UpdateProps';\nimport NativeReanimatedModule from '../reanimated2/NativeReanimated';\nimport { isSharedValue } from '../reanimated2/utils';\nimport type { AnimateProps } from '../reanimated2/helperTypes';\nimport { removeFromPropsRegistry } from '../reanimated2/PropsRegistry';\nimport { JSPropUpdater } from './JSPropUpdater';\nimport { getReduceMotionFromConfig } from '../reanimated2/animation/util';\nimport { maybeBuild } from '../animationBuilder';\nimport type { AnimatedComponentProps, AnimatedProps } from './utils';\nimport { flattenArray, has } from './utils';\n\nconst IS_WEB = isWeb();\n\nfunction dummyListener() {\n  // empty listener we use to assign to listener properties for which animated\n  // event is used.\n}\n\nfunction onlyAnimatedStyles(styles: StyleProps[]) {\n  return styles.filter((style) => style?.viewDescriptors);\n}\n\nfunction isSameAnimatedStyle(\n  style1?: StyleProps,\n  style2?: StyleProps\n): boolean {\n  // We cannot use equality check to compare useAnimatedStyle outputs directly.\n  // Instead, we can compare its viewsRefs.\n  return style1?.viewsRef === style2?.viewsRef;\n}\n\nconst isSameAnimatedProps = isSameAnimatedStyle;\n\nfunction isInlineStyleTransform(transform: any): boolean {\n  if (!transform) {\n    return false;\n  }\n  return transform.some((t: Record<string, any>) => hasInlineStyles(t));\n}\n\nfunction hasInlineStyles(style: StyleProps): boolean {\n  if (!style) {\n    return false;\n  }\n  return Object.keys(style).some((key) => {\n    const styleValue = style[key];\n    return (\n      isSharedValue(styleValue) ||\n      (key === 'transform' && isInlineStyleTransform(styleValue))\n    );\n  });\n}\n\nfunction extractSharedValuesMapFromProps(\n  props: AnimatedComponentProps<InitialComponentProps>\n): Record<string, any> {\n  const inlineProps: Record<string, any> = {};\n\n  for (const key in props) {\n    const value = props[key];\n    if (key === 'style') {\n      const styles = flattenArray<StyleProps>(props.style ?? []);\n      styles.forEach((style) => {\n        if (!style) {\n          return;\n        }\n        for (const [key, styleValue] of Object.entries(style)) {\n          if (isSharedValue(styleValue)) {\n            inlineProps[key] = styleValue;\n          } else if (\n            key === 'transform' &&\n            isInlineStyleTransform(styleValue)\n          ) {\n            inlineProps[key] = styleValue;\n          }\n        }\n      });\n    } else if (isSharedValue(value)) {\n      inlineProps[key] = value;\n    }\n  }\n\n  return inlineProps;\n}\n\nfunction inlinePropsHasChanged(styles1: StyleProps, styles2: StyleProps) {\n  if (Object.keys(styles1).length !== Object.keys(styles2).length) {\n    return true;\n  }\n\n  for (const key of Object.keys(styles1)) {\n    if (styles1[key] !== styles2[key]) return true;\n  }\n\n  return false;\n}\n\nfunction getInlinePropsUpdate(inlineProps: Record<string, any>) {\n  'worklet';\n  const update: Record<string, any> = {};\n  for (const [key, styleValue] of Object.entries(inlineProps)) {\n    if (key === 'transform') {\n      update[key] = styleValue.map((transform: Record<string, any>) => {\n        return getInlinePropsUpdate(transform);\n      });\n    } else if (isSharedValue(styleValue)) {\n      update[key] = styleValue.value;\n    } else {\n      update[key] = styleValue;\n    }\n  }\n  return update;\n}\n\ntype Options<P> = {\n  setNativeProps: (ref: ComponentRef, props: P) => void;\n};\n\ninterface ComponentRef extends Component {\n  setNativeProps?: (props: Record<string, unknown>) => void;\n  getScrollableNode?: () => ComponentRef;\n  getAnimatableRef?: () => ComponentRef;\n}\n\ninterface InitialComponentProps extends Record<string, unknown> {\n  ref?: Ref<Component>;\n  collapsable?: boolean;\n}\n\nexport default function createAnimatedComponent<P extends object>(\n  component: FunctionComponent<P>,\n  options?: Options<P>\n): FunctionComponent<AnimateProps<P>>;\n\nexport default function createAnimatedComponent<P extends object>(\n  component: ComponentClass<P>,\n  options?: Options<P>\n): ComponentClass<AnimateProps<P>>;\n\nexport default function createAnimatedComponent(\n  Component: ComponentType<InitialComponentProps>,\n  options?: Options<InitialComponentProps>\n): any {\n  invariant(\n    typeof Component !== 'function' ||\n      (Component.prototype && Component.prototype.isReactComponent),\n    `Looks like you're passing a function component \\`${Component.name}\\` to \\`createAnimatedComponent\\` function which supports only class components. Please wrap your function component with \\`React.forwardRef()\\` or use a class component instead.`\n  );\n\n  class AnimatedComponent extends React.Component<\n    AnimatedComponentProps<InitialComponentProps>\n  > {\n    _styles: StyleProps[] | null = null;\n    _animatedProps?: Partial<AnimatedComponentProps<AnimatedProps>>;\n    _viewTag = -1;\n    _isFirstRender = true;\n    animatedStyle: { value: StyleProps } = { value: {} };\n    initialStyle = {};\n    _component: ComponentRef | HTMLElement | null = null;\n    _inlinePropsViewDescriptors: ViewDescriptorsSet | null = null;\n    _inlinePropsMapperId: number | null = null;\n    _inlineProps: StyleProps = {};\n    _sharedElementTransition: SharedTransition | null = null;\n    _JSPropUpdater = new JSPropUpdater();\n    static displayName: string;\n\n    constructor(props: AnimatedComponentProps<InitialComponentProps>) {\n      super(props);\n      if (isJest()) {\n        this.animatedStyle = { value: {} };\n      }\n    }\n\n    componentWillUnmount() {\n      this._detachNativeEvents();\n      this._JSPropUpdater.removeOnJSPropsChangeListener(this);\n      this._detachStyles();\n      this._detachInlineProps();\n      this._sharedElementTransition?.unregisterTransition(this._viewTag);\n    }\n\n    componentDidMount() {\n      this._attachNativeEvents();\n      this._JSPropUpdater.addOnJSPropsChangeListener(this);\n      this._attachAnimatedStyles();\n      this._attachInlineProps();\n    }\n\n    _getEventViewRef() {\n      // Make sure to get the scrollable node for components that implement\n      // `ScrollResponder.Mixin`.\n      return (this._component as ComponentRef)?.getScrollableNode\n        ? (this._component as ComponentRef).getScrollableNode?.()\n        : this._component;\n    }\n\n    _attachNativeEvents() {\n      const node = this._getEventViewRef() as ComponentRef;\n      let viewTag = null; // We set it only if needed\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          if (viewTag === null) {\n            viewTag = findNodeHandle(options?.setNativeProps ? this : node);\n          }\n          prop.current.registerForEvents(viewTag as number, key);\n        }\n      }\n    }\n\n    _detachNativeEvents() {\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          prop.current.unregisterFromEvents();\n        }\n      }\n    }\n\n    _detachStyles() {\n      if (IS_WEB && this._styles !== null) {\n        for (const style of this._styles) {\n          if (style?.viewsRef) {\n            style.viewsRef.remove(this);\n          }\n        }\n      } else if (this._viewTag !== -1 && this._styles !== null) {\n        for (const style of this._styles) {\n          style.viewDescriptors.remove(this._viewTag);\n        }\n        if (this.props.animatedProps?.viewDescriptors) {\n          this.props.animatedProps.viewDescriptors.remove(this._viewTag);\n        }\n        if (global._IS_FABRIC) {\n          removeFromPropsRegistry(this._viewTag);\n        }\n      }\n    }\n\n    _reattachNativeEvents(\n      prevProps: AnimatedComponentProps<InitialComponentProps>\n    ) {\n      for (const key in prevProps) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler &&\n          prop.current.reattachNeeded\n        ) {\n          prop.current.unregisterFromEvents();\n        }\n      }\n\n      let viewTag = null;\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler &&\n          prop.current.reattachNeeded\n        ) {\n          if (viewTag === null) {\n            const node = this._getEventViewRef() as ComponentRef;\n            viewTag = findNodeHandle(options?.setNativeProps ? this : node);\n          }\n          prop.current.registerForEvents(viewTag as number, key);\n          prop.current.reattachNeeded = false;\n        }\n      }\n    }\n\n    _updateFromNative(props: StyleProps) {\n      if (options?.setNativeProps) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        options.setNativeProps(this._component as ComponentRef, props);\n      } else {\n        // eslint-disable-next-line no-unused-expressions\n        (this._component as ComponentRef)?.setNativeProps?.(props);\n      }\n    }\n\n    _getViewInfo() {\n      let viewTag: number | HTMLElement | null;\n      let viewName: string | null;\n      let shadowNodeWrapper: ShadowNodeWrapper | null = null;\n      let viewConfig;\n      // Component can specify ref which should be animated when animated version of the component is created.\n      // Otherwise, we animate the component itself.\n      const component = (this._component as ComponentRef)?.getAnimatableRef\n        ? (this._component as ComponentRef).getAnimatableRef?.()\n        : this;\n\n      if (IS_WEB) {\n        // At this point I assume that `_setComponentRef` was already called and `_component` is set.\n        // `this._component` on web represents HTMLElement of our component, that's why we use casting\n        viewTag = this._component as HTMLElement;\n        viewName = null;\n        shadowNodeWrapper = null;\n        viewConfig = null;\n      } else {\n        // hostInstance can be null for a component that doesn't render anything (render function returns null). Example: svg Stop: https://github.com/react-native-svg/react-native-svg/blob/develop/src/elements/Stop.tsx\n        const hostInstance = RNRenderer.findHostInstance_DEPRECATED(component);\n        if (!hostInstance) {\n          throw new Error(\n            '[Reanimated] Cannot find host instance for this component. Maybe it renders nothing?'\n          );\n        }\n        // we can access view tag in the same way it's accessed here https://github.com/facebook/react/blob/e3f4eb7272d4ca0ee49f27577156b57eeb07cf73/packages/react-native-renderer/src/ReactFabric.js#L146\n        viewTag = hostInstance?._nativeTag;\n        /**\n         * RN uses viewConfig for components for storing different properties of the component(example: https://github.com/facebook/react-native/blob/master/packages/react-native/Libraries/Components/ScrollView/ScrollViewViewConfig.js#L16).\n         * The name we're looking for is in the field named uiViewClassName.\n         */\n        viewName = hostInstance?.viewConfig?.uiViewClassName;\n\n        viewConfig = hostInstance?.viewConfig;\n\n        if (global._IS_FABRIC) {\n          shadowNodeWrapper = getShadowNodeWrapperFromRef(this);\n        }\n      }\n      return { viewTag, viewName, shadowNodeWrapper, viewConfig };\n    }\n\n    _attachAnimatedStyles() {\n      const styles = this.props.style\n        ? onlyAnimatedStyles(flattenArray<StyleProps>(this.props.style))\n        : [];\n      const prevStyles = this._styles;\n      this._styles = styles;\n\n      const prevAnimatedProps = this._animatedProps;\n      this._animatedProps = this.props.animatedProps;\n\n      const { viewTag, viewName, shadowNodeWrapper, viewConfig } =\n        this._getViewInfo();\n\n      // update UI props whitelist for this view\n      const hasReanimated2Props =\n        this.props.animatedProps?.viewDescriptors || styles.length;\n      if (hasReanimated2Props && viewConfig) {\n        adaptViewConfig(viewConfig);\n      }\n\n      this._viewTag = viewTag as number;\n\n      // remove old styles\n      if (prevStyles) {\n        // in most of the cases, views have only a single animated style and it remains unchanged\n        const hasOneSameStyle =\n          styles.length === 1 &&\n          prevStyles.length === 1 &&\n          isSameAnimatedStyle(styles[0], prevStyles[0]);\n\n        if (!hasOneSameStyle) {\n          // otherwise, remove each style that is not present in new styles\n          for (const prevStyle of prevStyles) {\n            const isPresent = styles.some((style) =>\n              isSameAnimatedStyle(style, prevStyle)\n            );\n            if (!isPresent) {\n              prevStyle.viewDescriptors.remove(viewTag);\n            }\n          }\n        }\n      }\n\n      styles.forEach((style) => {\n        style.viewDescriptors.add({\n          tag: viewTag,\n          name: viewName,\n          shadowNodeWrapper,\n        });\n        if (isJest()) {\n          /**\n           * We need to connect Jest's TestObject instance whose contains just props object\n           * with the updateProps() function where we update the properties of the component.\n           * We can't update props object directly because TestObject contains a copy of props - look at render function:\n           * const props = this._filterNonAnimatedProps(this.props);\n           */\n          this.animatedStyle.value = {\n            ...this.animatedStyle.value,\n            ...style.initial.value,\n          };\n          style.animatedStyle.current = this.animatedStyle;\n        }\n      });\n\n      // detach old animatedProps\n      if (\n        prevAnimatedProps &&\n        !isSameAnimatedProps(prevAnimatedProps, this.props.animatedProps)\n      ) {\n        prevAnimatedProps.viewDescriptors!.remove(viewTag as number);\n      }\n\n      // attach animatedProps property\n      if (this.props.animatedProps?.viewDescriptors) {\n        this.props.animatedProps.viewDescriptors.add({\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          tag: viewTag as number,\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          name: viewName!,\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          shadowNodeWrapper: shadowNodeWrapper!,\n        });\n      }\n    }\n\n    _attachInlineProps() {\n      const newInlineProps: Record<string, any> =\n        extractSharedValuesMapFromProps(this.props);\n      const hasChanged = inlinePropsHasChanged(\n        newInlineProps,\n        this._inlineProps\n      );\n\n      if (hasChanged) {\n        if (!this._inlinePropsViewDescriptors) {\n          this._inlinePropsViewDescriptors = makeViewDescriptorsSet();\n\n          const { viewTag, viewName, shadowNodeWrapper, viewConfig } =\n            this._getViewInfo();\n\n          if (Object.keys(newInlineProps).length && viewConfig) {\n            adaptViewConfig(viewConfig);\n          }\n\n          this._inlinePropsViewDescriptors.add({\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            tag: viewTag as number,\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            name: viewName!,\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            shadowNodeWrapper: shadowNodeWrapper!,\n          });\n        }\n        const sharableViewDescriptors =\n          this._inlinePropsViewDescriptors.sharableViewDescriptors;\n\n        const maybeViewRef = NativeReanimatedModule.native\n          ? undefined\n          : ({ items: new Set([this]) } as ViewRefSet<any>); // see makeViewsRefSet\n\n        const updaterFunction = () => {\n          'worklet';\n          const update = getInlinePropsUpdate(newInlineProps);\n          updateProps(sharableViewDescriptors, update, maybeViewRef);\n        };\n        this._inlineProps = newInlineProps;\n        if (this._inlinePropsMapperId) {\n          stopMapper(this._inlinePropsMapperId);\n        }\n        this._inlinePropsMapperId = null;\n        if (Object.keys(newInlineProps).length) {\n          this._inlinePropsMapperId = startMapper(\n            updaterFunction,\n            Object.values(newInlineProps)\n          );\n        }\n      }\n    }\n\n    _detachInlineProps() {\n      if (this._inlinePropsMapperId) {\n        stopMapper(this._inlinePropsMapperId);\n      }\n    }\n\n    componentDidUpdate(\n      prevProps: AnimatedComponentProps<InitialComponentProps>\n    ) {\n      this._reattachNativeEvents(prevProps);\n      this._attachAnimatedStyles();\n      this._attachInlineProps();\n    }\n\n    _setComponentRef = setAndForwardRef<Component | HTMLElement>({\n      getForwardedRef: () =>\n        this.props.forwardedRef as MutableRefObject<\n          Component<Record<string, unknown>, Record<string, unknown>, unknown>\n        >,\n      setLocalRef: (ref) => {\n        // TODO update config\n\n        const tag = IS_WEB\n          ? (ref as HTMLElement)\n          : findNodeHandle(ref as Component);\n\n        const { layout, entering, exiting, sharedTransitionTag } = this.props;\n        if (\n          (layout || entering || exiting || sharedTransitionTag) &&\n          tag != null\n        ) {\n          if (!shouldBeUseWeb()) {\n            enableLayoutAnimations(true, false);\n          }\n          if (layout) {\n            configureLayoutAnimations(\n              tag,\n              LayoutAnimationType.LAYOUT,\n              maybeBuild(\n                layout,\n                undefined /* We don't have to warn user if style has common properties with animation for LAYOUT */,\n                AnimatedComponent.displayName\n              )\n            );\n          }\n          if (entering) {\n            configureLayoutAnimations(\n              tag,\n              LayoutAnimationType.ENTERING,\n              maybeBuild(\n                entering,\n                this.props?.style,\n                AnimatedComponent.displayName\n              )\n            );\n          }\n          if (exiting) {\n            const reduceMotionInExiting =\n              'getReduceMotion' in exiting &&\n              typeof exiting.getReduceMotion === 'function'\n                ? getReduceMotionFromConfig(exiting.getReduceMotion())\n                : getReduceMotionFromConfig();\n            if (!reduceMotionInExiting) {\n              configureLayoutAnimations(\n                tag,\n                LayoutAnimationType.EXITING,\n                maybeBuild(\n                  exiting,\n                  this.props?.style,\n                  AnimatedComponent.displayName\n                )\n              );\n            }\n          }\n          if (sharedTransitionTag && !IS_WEB) {\n            const sharedElementTransition =\n              this.props.sharedTransitionStyle ?? new SharedTransition();\n            const reduceMotionInTransition = getReduceMotionFromConfig(\n              sharedElementTransition.getReduceMotion()\n            );\n            if (!reduceMotionInTransition) {\n              sharedElementTransition.registerTransition(\n                tag as number,\n                sharedTransitionTag\n              );\n              this._sharedElementTransition = sharedElementTransition;\n            }\n          }\n        }\n\n        if (ref !== this._component) {\n          this._component = ref;\n        }\n      },\n    });\n\n    _filterNonAnimatedProps(\n      inputProps: AnimatedComponentProps<InitialComponentProps>\n    ): Record<string, unknown> {\n      const props: Record<string, unknown> = {};\n      for (const key in inputProps) {\n        const value = inputProps[key];\n        if (key === 'style') {\n          const styleProp = inputProps.style;\n          const styles = flattenArray<StyleProps>(styleProp ?? []);\n          const processedStyle: StyleProps = styles.map((style) => {\n            if (style && style.viewDescriptors) {\n              // this is how we recognize styles returned by useAnimatedStyle\n              style.viewsRef.add(this);\n              if (this._isFirstRender) {\n                this.initialStyle = {\n                  ...style.initial.value,\n                  ...this.initialStyle,\n                  ...initialUpdaterRun<StyleProps>(style.initial.updater),\n                };\n              }\n              return this.initialStyle;\n            } else if (hasInlineStyles(style)) {\n              if (this._isFirstRender) {\n                return getInlinePropsUpdate(style);\n              }\n              const newStyle: StyleProps = {};\n              for (const [key, styleValue] of Object.entries(style)) {\n                if (\n                  !isSharedValue(styleValue) &&\n                  !(key === 'transform' && isInlineStyleTransform(styleValue))\n                ) {\n                  newStyle[key] = styleValue;\n                }\n              }\n              return newStyle;\n            } else {\n              return style;\n            }\n          });\n          props[key] = StyleSheet.flatten(processedStyle);\n        } else if (key === 'animatedProps') {\n          const animatedProp = inputProps.animatedProps as Partial<\n            AnimatedComponentProps<AnimatedProps>\n          >;\n          if (animatedProp.initial !== undefined) {\n            Object.keys(animatedProp.initial.value).forEach((key) => {\n              props[key] = animatedProp.initial?.value[key];\n              animatedProp.viewsRef?.add(this);\n            });\n          }\n        } else if (\n          has('current', value) &&\n          value.current instanceof WorkletEventHandler\n        ) {\n          if (value.current.eventNames.length > 0) {\n            value.current.eventNames.forEach((eventName) => {\n              props[eventName] = has('listeners', value.current)\n                ? (value.current.listeners as Record<string, unknown>)[\n                    eventName\n                  ]\n                : dummyListener;\n            });\n          } else {\n            props[key] = dummyListener;\n          }\n        } else if (isSharedValue(value)) {\n          if (this._isFirstRender) {\n            props[key] = (value as SharedValue<any>).value;\n          }\n        } else if (\n          key !== 'onGestureHandlerStateChange' ||\n          !isChromeDebugger()\n        ) {\n          props[key] = value;\n        }\n      }\n      return props;\n    }\n\n    render() {\n      const props = this._filterNonAnimatedProps(this.props);\n      if (isJest()) {\n        props.animatedStyle = this.animatedStyle;\n      }\n\n      if (this._isFirstRender) {\n        this._isFirstRender = false;\n      }\n\n      const platformProps = Platform.select({\n        web: {},\n        default: { collapsable: false },\n      });\n\n      return (\n        <Component\n          {...props}\n          // Casting is used here, because ref can be null - in that case it cannot be assigned to HTMLElement.\n          // After spending some time trying to figure out what to do with this problem, we decided to leave it this way\n          ref={this._setComponentRef as (ref: Component) => void}\n          {...platformProps}\n        />\n      );\n    }\n  }\n\n  AnimatedComponent.displayName = `AnimatedComponent(${\n    Component.displayName || Component.name || 'Component'\n  })`;\n\n  return React.forwardRef<Component>((props, ref) => {\n    return (\n      <AnimatedComponent\n        {...props}\n        {...(ref === null ? null : { forwardedRef: ref })}\n      />\n    );\n  });\n}\n"],"mappings":";;;;AAQA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,cAAc,EAAEC,QAAQ,EAAEC,UAAU,QAAQ,cAAc;AACnE,OAAOC,mBAAmB,MAAM,oCAAoC;AACpE,OAAOC,gBAAgB,MAAM,oBAAoB;AACjD,OAAO,oDAAoD;AAC3D,OAAOC,SAAS,MAAM,WAAW;AACjC,SAASC,eAAe,QAAQ,iBAAiB;AACjD,SAASC,UAAU,QAAQ,6CAA6C;AACxE,SACEC,yBAAyB,EACzBC,sBAAsB,EACtBC,WAAW,EACXC,UAAU,QACL,qBAAqB;AAC5B,SACEC,MAAM,EACNC,gBAAgB,EAChBC,cAAc,EACdC,KAAK,QACA,gCAAgC;AACvC,SAASC,iBAAiB,QAAQ,0BAA0B;AAC5D,SACEC,gBAAgB,EAChBC,mBAAmB,QACd,kCAAkC;AAUzC,SAASC,sBAAsB,QAAQ,mCAAmC;AAC1E,SAASC,2BAA2B,QAAQ,4BAA4B;AACxE,OAAOC,WAAW,MAAM,4BAA4B;AACpD,OAAOC,sBAAsB,MAAM,iCAAiC;AACpE,SAASC,aAAa,QAAQ,sBAAsB;AAEpD,SAASC,uBAAuB,QAAQ,8BAA8B;AACtE,SAASC,aAAa,QAAQ,iBAAiB;AAC/C,SAASC,yBAAyB,QAAQ,+BAA+B;AACzE,SAASC,UAAU,QAAQ,qBAAqB;AAEhD,SAASC,YAAY,EAAEC,GAAG,QAAQ,SAAS;AAE3C,MAAMC,MAAM,GAAGf,KAAK,EAAE;AAEtB,SAASgB,aAAaA,CAAA,EAAG;EACvB;EACA;AAAA;AAGF,SAASC,kBAAkBA,CAACC,MAAoB,EAAE;EAChD,OAAOA,MAAM,CAACC,MAAM,CAAEC,KAAK,IAAKA,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEC,eAAe,CAAC;AACzD;AAEA,SAASC,mBAAmBA,CAC1BC,MAAmB,EACnBC,MAAmB,EACV;EACT;EACA;EACA,OAAO,CAAAD,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEE,QAAQ,OAAKD,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEC,QAAQ;AAC9C;AAEA,MAAMC,mBAAmB,GAAGJ,mBAAmB;AAE/C,SAASK,sBAAsBA,CAACC,SAAc,EAAW;EACvD,IAAI,CAACA,SAAS,EAAE;IACd,OAAO,KAAK;EACd;EACA,OAAOA,SAAS,CAACC,IAAI,CAAEC,CAAsB,IAAKC,eAAe,CAACD,CAAC,CAAC,CAAC;AACvE;AAEA,SAASC,eAAeA,CAACX,KAAiB,EAAW;EACnD,IAAI,CAACA,KAAK,EAAE;IACV,OAAO,KAAK;EACd;EACA,OAAOY,MAAM,CAACC,IAAI,CAACb,KAAK,CAAC,CAACS,IAAI,CAAEK,GAAG,IAAK;IACtC,MAAMC,UAAU,GAAGf,KAAK,CAACc,GAAG,CAAC;IAC7B,OACE1B,aAAa,CAAC2B,UAAU,CAAC,IACxBD,GAAG,KAAK,WAAW,IAAIP,sBAAsB,CAACQ,UAAU,CAAE;EAE/D,CAAC,CAAC;AACJ;AAEA,SAASC,+BAA+BA,CACtCC,KAAoD,EAC/B;EACrB,MAAMC,WAAgC,GAAG,CAAC,CAAC;EAE3C,KAAK,MAAMJ,GAAG,IAAIG,KAAK,EAAE;IACvB,MAAME,KAAK,GAAGF,KAAK,CAACH,GAAG,CAAC;IACxB,IAAIA,GAAG,KAAK,OAAO,EAAE;MACnB,MAAMhB,MAAM,GAAGL,YAAY,CAAawB,KAAK,CAACjB,KAAK,IAAI,EAAE,CAAC;MAC1DF,MAAM,CAACsB,OAAO,CAAEpB,KAAK,IAAK;QACxB,IAAI,CAACA,KAAK,EAAE;UACV;QACF;QACA,KAAK,MAAM,CAACc,GAAG,EAAEC,UAAU,CAAC,IAAIH,MAAM,CAACS,OAAO,CAACrB,KAAK,CAAC,EAAE;UACrD,IAAIZ,aAAa,CAAC2B,UAAU,CAAC,EAAE;YAC7BG,WAAW,CAACJ,GAAG,CAAC,GAAGC,UAAU;UAC/B,CAAC,MAAM,IACLD,GAAG,KAAK,WAAW,IACnBP,sBAAsB,CAACQ,UAAU,CAAC,EAClC;YACAG,WAAW,CAACJ,GAAG,CAAC,GAAGC,UAAU;UAC/B;QACF;MACF,CAAC,CAAC;IACJ,CAAC,MAAM,IAAI3B,aAAa,CAAC+B,KAAK,CAAC,EAAE;MAC/BD,WAAW,CAACJ,GAAG,CAAC,GAAGK,KAAK;IAC1B;EACF;EAEA,OAAOD,WAAW;AACpB;AAEA,SAASI,qBAAqBA,CAACC,OAAmB,EAAEC,OAAmB,EAAE;EACvE,IAAIZ,MAAM,CAACC,IAAI,CAACU,OAAO,CAAC,CAACE,MAAM,KAAKb,MAAM,CAACC,IAAI,CAACW,OAAO,CAAC,CAACC,MAAM,EAAE;IAC/D,OAAO,IAAI;EACb;EAEA,KAAK,MAAMX,GAAG,IAAIF,MAAM,CAACC,IAAI,CAACU,OAAO,CAAC,EAAE;IACtC,IAAIA,OAAO,CAACT,GAAG,CAAC,KAAKU,OAAO,CAACV,GAAG,CAAC,EAAE,OAAO,IAAI;EAChD;EAEA,OAAO,KAAK;AACd;AAEA,SAASY,oBAAoBA,CAACR,WAAgC,EAAE;EAC9D,SAAS;;EACT,MAAMS,MAA2B,GAAG,CAAC,CAAC;EACtC,KAAK,MAAM,CAACb,GAAG,EAAEC,UAAU,CAAC,IAAIH,MAAM,CAACS,OAAO,CAACH,WAAW,CAAC,EAAE;IAC3D,IAAIJ,GAAG,KAAK,WAAW,EAAE;MACvBa,MAAM,CAACb,GAAG,CAAC,GAAGC,UAAU,CAACa,GAAG,CAAEpB,SAA8B,IAAK;QAC/D,OAAOkB,oBAAoB,CAAClB,SAAS,CAAC;MACxC,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIpB,aAAa,CAAC2B,UAAU,CAAC,EAAE;MACpCY,MAAM,CAACb,GAAG,CAAC,GAAGC,UAAU,CAACI,KAAK;IAChC,CAAC,MAAM;MACLQ,MAAM,CAACb,GAAG,CAAC,GAAGC,UAAU;IAC1B;EACF;EACA,OAAOY,MAAM;AACf;AA2BA,eAAe,SAASE,uBAAuBA,CAC7CC,SAA+C,EAC/CC,OAAwC,EACnC;EACL7D,SAAS,CACP,OAAO4D,SAAS,KAAK,UAAU,IAC5BA,SAAS,CAACE,SAAS,IAAIF,SAAS,CAACE,SAAS,CAACC,gBAAiB,EAC9D,oDAAmDH,SAAS,CAACI,IAAK,oLAAmL,CACvP;EAED,MAAMC,iBAAiB,SAASvE,KAAK,CAACkE,SAAS,CAE7C;IAeAM,WAAWA,CAACnB,KAAoD,EAAE;MAChE,KAAK,CAACA,KAAK,CAAC;MAACoB,eAAA,kBAfgB,IAAI;MAAAA,eAAA;MAAAA,eAAA,mBAExB,CAAC,CAAC;MAAAA,eAAA,yBACI,IAAI;MAAAA,eAAA,wBACkB;QAAElB,KAAK,EAAE,CAAC;MAAE,CAAC;MAAAkB,eAAA,uBACrC,CAAC,CAAC;MAAAA,eAAA,qBAC+B,IAAI;MAAAA,eAAA,sCACK,IAAI;MAAAA,eAAA,+BACvB,IAAI;MAAAA,eAAA,uBACf,CAAC,CAAC;MAAAA,eAAA,mCACuB,IAAI;MAAAA,eAAA,yBACvC,IAAI/C,aAAa,EAAE;MAAA+C,eAAA,2BAkUjBpE,gBAAgB,CAA0B;QAC3DqE,eAAe,EAAEA,CAAA,KACf,IAAI,CAACrB,KAAK,CAACsB,YAEV;QACHC,WAAW,EAAGC,GAAG,IAAK;UACpB;;UAEA,MAAMC,GAAG,GAAG/C,MAAM,GACb8C,GAAG,GACJ5E,cAAc,CAAC4E,GAAG,CAAc;UAEpC,MAAM;YAAEE,MAAM;YAAEC,QAAQ;YAAEC,OAAO;YAAEC;UAAoB,CAAC,GAAG,IAAI,CAAC7B,KAAK;UACrE,IACE,CAAC0B,MAAM,IAAIC,QAAQ,IAAIC,OAAO,IAAIC,mBAAmB,KACrDJ,GAAG,IAAI,IAAI,EACX;YACA,IAAI,CAAC/D,cAAc,EAAE,EAAE;cACrBL,sBAAsB,CAAC,IAAI,EAAE,KAAK,CAAC;YACrC;YACA,IAAIqE,MAAM,EAAE;cACVtE,yBAAyB,CACvBqE,GAAG,EACH3D,mBAAmB,CAACgE,MAAM,EAC1BvD,UAAU,CACRmD,MAAM,EACNK,SAAS,CAAC,2FACVb,iBAAiB,CAACc,WAAW,CAC9B,CACF;YACH;YACA,IAAIL,QAAQ,EAAE;cAAA,IAAAM,WAAA;cACZ7E,yBAAyB,CACvBqE,GAAG,EACH3D,mBAAmB,CAACoE,QAAQ,EAC5B3D,UAAU,CACRoD,QAAQ,GAAAM,WAAA,GACR,IAAI,CAACjC,KAAK,cAAAiC,WAAA,uBAAVA,WAAA,CAAYlD,KAAK,EACjBmC,iBAAiB,CAACc,WAAW,CAC9B,CACF;YACH;YACA,IAAIJ,OAAO,EAAE;cACX,MAAMO,qBAAqB,GACzB,iBAAiB,IAAIP,OAAO,IAC5B,OAAOA,OAAO,CAACQ,eAAe,KAAK,UAAU,GACzC9D,yBAAyB,CAACsD,OAAO,CAACQ,eAAe,EAAE,CAAC,GACpD9D,yBAAyB,EAAE;cACjC,IAAI,CAAC6D,qBAAqB,EAAE;gBAAA,IAAAE,YAAA;gBAC1BjF,yBAAyB,CACvBqE,GAAG,EACH3D,mBAAmB,CAACwE,OAAO,EAC3B/D,UAAU,CACRqD,OAAO,GAAAS,YAAA,GACP,IAAI,CAACrC,KAAK,cAAAqC,YAAA,uBAAVA,YAAA,CAAYtD,KAAK,EACjBmC,iBAAiB,CAACc,WAAW,CAC9B,CACF;cACH;YACF;YACA,IAAIH,mBAAmB,IAAI,CAACnD,MAAM,EAAE;cAClC,MAAM6D,uBAAuB,GAC3B,IAAI,CAACvC,KAAK,CAACwC,qBAAqB,IAAI,IAAI3E,gBAAgB,EAAE;cAC5D,MAAM4E,wBAAwB,GAAGnE,yBAAyB,CACxDiE,uBAAuB,CAACH,eAAe,EAAE,CAC1C;cACD,IAAI,CAACK,wBAAwB,EAAE;gBAC7BF,uBAAuB,CAACG,kBAAkB,CACxCjB,GAAG,EACHI,mBAAmB,CACpB;gBACD,IAAI,CAACc,wBAAwB,GAAGJ,uBAAuB;cACzD;YACF;UACF;UAEA,IAAIf,GAAG,KAAK,IAAI,CAACoB,UAAU,EAAE;YAC3B,IAAI,CAACA,UAAU,GAAGpB,GAAG;UACvB;QACF;MACF,CAAC,CAAC;MA7YA,IAAIhE,MAAM,EAAE,EAAE;QACZ,IAAI,CAACqF,aAAa,GAAG;UAAE3C,KAAK,EAAE,CAAC;QAAE,CAAC;MACpC;IACF;IAEA4C,oBAAoBA,CAAA,EAAG;MAAA,IAAAC,qBAAA;MACrB,IAAI,CAACC,mBAAmB,EAAE;MAC1B,IAAI,CAACC,cAAc,CAACC,6BAA6B,CAAC,IAAI,CAAC;MACvD,IAAI,CAACC,aAAa,EAAE;MACpB,IAAI,CAACC,kBAAkB,EAAE;MACzB,CAAAL,qBAAA,OAAI,CAACJ,wBAAwB,cAAAI,qBAAA,uBAA7BA,qBAAA,CAA+BM,oBAAoB,CAAC,IAAI,CAACC,QAAQ,CAAC;IACpE;IAEAC,iBAAiBA,CAAA,EAAG;MAClB,IAAI,CAACC,mBAAmB,EAAE;MAC1B,IAAI,CAACP,cAAc,CAACQ,0BAA0B,CAAC,IAAI,CAAC;MACpD,IAAI,CAACC,qBAAqB,EAAE;MAC5B,IAAI,CAACC,kBAAkB,EAAE;IAC3B;IAEAC,gBAAgBA,CAAA,EAAG;MAAA,IAAAC,gBAAA,EAAAC,kBAAA,EAAAC,IAAA;MACjB;MACA;MACA,OAAO,CAAAF,gBAAA,GAAC,IAAI,CAACjB,UAAU,cAAAiB,gBAAA,eAAhBA,gBAAA,CAAmCG,iBAAiB,IAAAF,kBAAA,GACvD,CAAAC,IAAA,GAAC,IAAI,CAACnB,UAAU,EAAkBoB,iBAAiB,cAAAF,kBAAA,uBAAnDA,kBAAA,CAAAG,IAAA,CAAAF,IAAA,CAAuD,GACvD,IAAI,CAACnB,UAAU;IACrB;IAEAY,mBAAmBA,CAAA,EAAG;MACpB,MAAMU,IAAI,GAAG,IAAI,CAACN,gBAAgB,EAAkB;MACpD,IAAIO,OAAO,GAAG,IAAI,CAAC,CAAC;;MAEpB,KAAK,MAAMtE,GAAG,IAAI,IAAI,CAACG,KAAK,EAAE;QAC5B,MAAMoE,IAAI,GAAG,IAAI,CAACpE,KAAK,CAACH,GAAG,CAAC;QAC5B,IACEpB,GAAG,CAAC,SAAS,EAAE2F,IAAI,CAAC,IACpBA,IAAI,CAACC,OAAO,YAAYtH,mBAAmB,EAC3C;UACA,IAAIoH,OAAO,KAAK,IAAI,EAAE;YACpBA,OAAO,GAAGvH,cAAc,CAACkE,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEwD,cAAc,GAAG,IAAI,GAAGJ,IAAI,CAAC;UACjE;UACAE,IAAI,CAACC,OAAO,CAACE,iBAAiB,CAACJ,OAAO,EAAYtE,GAAG,CAAC;QACxD;MACF;IACF;IAEAmD,mBAAmBA,CAAA,EAAG;MACpB,KAAK,MAAMnD,GAAG,IAAI,IAAI,CAACG,KAAK,EAAE;QAC5B,MAAMoE,IAAI,GAAG,IAAI,CAACpE,KAAK,CAACH,GAAG,CAAC;QAC5B,IACEpB,GAAG,CAAC,SAAS,EAAE2F,IAAI,CAAC,IACpBA,IAAI,CAACC,OAAO,YAAYtH,mBAAmB,EAC3C;UACAqH,IAAI,CAACC,OAAO,CAACG,oBAAoB,EAAE;QACrC;MACF;IACF;IAEArB,aAAaA,CAAA,EAAG;MACd,IAAIzE,MAAM,IAAI,IAAI,CAAC+F,OAAO,KAAK,IAAI,EAAE;QACnC,KAAK,MAAM1F,KAAK,IAAI,IAAI,CAAC0F,OAAO,EAAE;UAChC,IAAI1F,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEK,QAAQ,EAAE;YACnBL,KAAK,CAACK,QAAQ,CAACsF,MAAM,CAAC,IAAI,CAAC;UAC7B;QACF;MACF,CAAC,MAAM,IAAI,IAAI,CAACpB,QAAQ,KAAK,CAAC,CAAC,IAAI,IAAI,CAACmB,OAAO,KAAK,IAAI,EAAE;QAAA,IAAAE,qBAAA;QACxD,KAAK,MAAM5F,KAAK,IAAI,IAAI,CAAC0F,OAAO,EAAE;UAChC1F,KAAK,CAACC,eAAe,CAAC0F,MAAM,CAAC,IAAI,CAACpB,QAAQ,CAAC;QAC7C;QACA,KAAAqB,qBAAA,GAAI,IAAI,CAAC3E,KAAK,CAAC4E,aAAa,cAAAD,qBAAA,eAAxBA,qBAAA,CAA0B3F,eAAe,EAAE;UAC7C,IAAI,CAACgB,KAAK,CAAC4E,aAAa,CAAC5F,eAAe,CAAC0F,MAAM,CAAC,IAAI,CAACpB,QAAQ,CAAC;QAChE;QACA,IAAIuB,MAAM,CAACC,UAAU,EAAE;UACrB1G,uBAAuB,CAAC,IAAI,CAACkF,QAAQ,CAAC;QACxC;MACF;IACF;IAEAyB,qBAAqBA,CACnBC,SAAwD,EACxD;MACA,KAAK,MAAMnF,GAAG,IAAImF,SAAS,EAAE;QAC3B,MAAMZ,IAAI,GAAG,IAAI,CAACpE,KAAK,CAACH,GAAG,CAAC;QAC5B,IACEpB,GAAG,CAAC,SAAS,EAAE2F,IAAI,CAAC,IACpBA,IAAI,CAACC,OAAO,YAAYtH,mBAAmB,IAC3CqH,IAAI,CAACC,OAAO,CAACY,cAAc,EAC3B;UACAb,IAAI,CAACC,OAAO,CAACG,oBAAoB,EAAE;QACrC;MACF;MAEA,IAAIL,OAAO,GAAG,IAAI;MAElB,KAAK,MAAMtE,GAAG,IAAI,IAAI,CAACG,KAAK,EAAE;QAC5B,MAAMoE,IAAI,GAAG,IAAI,CAACpE,KAAK,CAACH,GAAG,CAAC;QAC5B,IACEpB,GAAG,CAAC,SAAS,EAAE2F,IAAI,CAAC,IACpBA,IAAI,CAACC,OAAO,YAAYtH,mBAAmB,IAC3CqH,IAAI,CAACC,OAAO,CAACY,cAAc,EAC3B;UACA,IAAId,OAAO,KAAK,IAAI,EAAE;YACpB,MAAMD,IAAI,GAAG,IAAI,CAACN,gBAAgB,EAAkB;YACpDO,OAAO,GAAGvH,cAAc,CAACkE,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEwD,cAAc,GAAG,IAAI,GAAGJ,IAAI,CAAC;UACjE;UACAE,IAAI,CAACC,OAAO,CAACE,iBAAiB,CAACJ,OAAO,EAAYtE,GAAG,CAAC;UACtDuE,IAAI,CAACC,OAAO,CAACY,cAAc,GAAG,KAAK;QACrC;MACF;IACF;IAEAC,iBAAiBA,CAAClF,KAAiB,EAAE;MACnC,IAAIc,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEwD,cAAc,EAAE;QAC3B;QACAxD,OAAO,CAACwD,cAAc,CAAC,IAAI,CAAC1B,UAAU,EAAkB5C,KAAK,CAAC;MAChE,CAAC,MAAM;QAAA,IAAAmF,iBAAA,EAAAC,qBAAA;QACL;QACA,CAAAD,iBAAA,GAAC,IAAI,CAACvC,UAAU,cAAAuC,iBAAA,wBAAAC,qBAAA,GAAhBD,iBAAA,CAAmCb,cAAc,cAAAc,qBAAA,uBAAjDA,qBAAA,CAAAnB,IAAA,CAAAkB,iBAAA,EAAoDnF,KAAK,CAAC;MAC5D;IACF;IAEAqF,YAAYA,CAAA,EAAG;MAAA,IAAAC,iBAAA,EAAAC,iBAAA,EAAAC,KAAA;MACb,IAAIrB,OAAoC;MACxC,IAAIsB,QAAuB;MAC3B,IAAIC,iBAA2C,GAAG,IAAI;MACtD,IAAIC,UAAU;MACd;MACA;MACA,MAAMC,SAAS,GAAG,CAAAN,iBAAA,GAAC,IAAI,CAAC1C,UAAU,cAAA0C,iBAAA,eAAhBA,iBAAA,CAAmCO,gBAAgB,IAAAN,iBAAA,GACjE,CAAAC,KAAA,GAAC,IAAI,CAAC5C,UAAU,EAAkBiD,gBAAgB,cAAAN,iBAAA,uBAAlDA,iBAAA,CAAAtB,IAAA,CAAAuB,KAAA,CAAsD,GACtD,IAAI;MAER,IAAI9G,MAAM,EAAE;QACV;QACA;QACAyF,OAAO,GAAG,IAAI,CAACvB,UAAyB;QACxC6C,QAAQ,GAAG,IAAI;QACfC,iBAAiB,GAAG,IAAI;QACxBC,UAAU,GAAG,IAAI;MACnB,CAAC,MAAM;QAAA,IAAAG,qBAAA;QACL;QACA,MAAMC,YAAY,GAAG5I,UAAU,CAAC6I,2BAA2B,CAACJ,SAAS,CAAC;QACtE,IAAI,CAACG,YAAY,EAAE;UACjB,MAAM,IAAIE,KAAK,CACb,sFAAsF,CACvF;QACH;QACA;QACA9B,OAAO,GAAG4B,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEG,UAAU;QAClC;AACR;AACA;AACA;QACQT,QAAQ,GAAGM,YAAY,aAAZA,YAAY,wBAAAD,qBAAA,GAAZC,YAAY,CAAEJ,UAAU,cAAAG,qBAAA,uBAAxBA,qBAAA,CAA0BK,eAAe;QAEpDR,UAAU,GAAGI,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEJ,UAAU;QAErC,IAAId,MAAM,CAACC,UAAU,EAAE;UACrBY,iBAAiB,GAAG1H,2BAA2B,CAAC,IAAI,CAAC;QACvD;MACF;MACA,OAAO;QAAEmG,OAAO;QAAEsB,QAAQ;QAAEC,iBAAiB;QAAEC;MAAW,CAAC;IAC7D;IAEAjC,qBAAqBA,CAAA,EAAG;MAAA,IAAA0C,sBAAA,EAAAC,sBAAA;MACtB,MAAMxH,MAAM,GAAG,IAAI,CAACmB,KAAK,CAACjB,KAAK,GAC3BH,kBAAkB,CAACJ,YAAY,CAAa,IAAI,CAACwB,KAAK,CAACjB,KAAK,CAAC,CAAC,GAC9D,EAAE;MACN,MAAMuH,UAAU,GAAG,IAAI,CAAC7B,OAAO;MAC/B,IAAI,CAACA,OAAO,GAAG5F,MAAM;MAErB,MAAM0H,iBAAiB,GAAG,IAAI,CAACC,cAAc;MAC7C,IAAI,CAACA,cAAc,GAAG,IAAI,CAACxG,KAAK,CAAC4E,aAAa;MAE9C,MAAM;QAAET,OAAO;QAAEsB,QAAQ;QAAEC,iBAAiB;QAAEC;MAAW,CAAC,GACxD,IAAI,CAACN,YAAY,EAAE;;MAErB;MACA,MAAMoB,mBAAmB,GACvB,EAAAL,sBAAA,OAAI,CAACpG,KAAK,CAAC4E,aAAa,cAAAwB,sBAAA,uBAAxBA,sBAAA,CAA0BpH,eAAe,KAAIH,MAAM,CAAC2B,MAAM;MAC5D,IAAIiG,mBAAmB,IAAId,UAAU,EAAE;QACrCzI,eAAe,CAACyI,UAAU,CAAC;MAC7B;MAEA,IAAI,CAACrC,QAAQ,GAAGa,OAAiB;;MAEjC;MACA,IAAImC,UAAU,EAAE;QACd;QACA,MAAMI,eAAe,GACnB7H,MAAM,CAAC2B,MAAM,KAAK,CAAC,IACnB8F,UAAU,CAAC9F,MAAM,KAAK,CAAC,IACvBvB,mBAAmB,CAACJ,MAAM,CAAC,CAAC,CAAC,EAAEyH,UAAU,CAAC,CAAC,CAAC,CAAC;QAE/C,IAAI,CAACI,eAAe,EAAE;UACpB;UACA,KAAK,MAAMC,SAAS,IAAIL,UAAU,EAAE;YAClC,MAAMM,SAAS,GAAG/H,MAAM,CAACW,IAAI,CAAET,KAAK,IAClCE,mBAAmB,CAACF,KAAK,EAAE4H,SAAS,CAAC,CACtC;YACD,IAAI,CAACC,SAAS,EAAE;cACdD,SAAS,CAAC3H,eAAe,CAAC0F,MAAM,CAACP,OAAO,CAAC;YAC3C;UACF;QACF;MACF;MAEAtF,MAAM,CAACsB,OAAO,CAAEpB,KAAK,IAAK;QACxBA,KAAK,CAACC,eAAe,CAAC6H,GAAG,CAAC;UACxBpF,GAAG,EAAE0C,OAAO;UACZlD,IAAI,EAAEwE,QAAQ;UACdC;QACF,CAAC,CAAC;QACF,IAAIlI,MAAM,EAAE,EAAE;UACZ;AACV;AACA;AACA;AACA;AACA;UACU,IAAI,CAACqF,aAAa,CAAC3C,KAAK,GAAG;YACzB,GAAG,IAAI,CAAC2C,aAAa,CAAC3C,KAAK;YAC3B,GAAGnB,KAAK,CAAC+H,OAAO,CAAC5G;UACnB,CAAC;UACDnB,KAAK,CAAC8D,aAAa,CAACwB,OAAO,GAAG,IAAI,CAACxB,aAAa;QAClD;MACF,CAAC,CAAC;;MAEF;MACA,IACE0D,iBAAiB,IACjB,CAAClH,mBAAmB,CAACkH,iBAAiB,EAAE,IAAI,CAACvG,KAAK,CAAC4E,aAAa,CAAC,EACjE;QACA2B,iBAAiB,CAACvH,eAAe,CAAE0F,MAAM,CAACP,OAAO,CAAW;MAC9D;;MAEA;MACA,KAAAkC,sBAAA,GAAI,IAAI,CAACrG,KAAK,CAAC4E,aAAa,cAAAyB,sBAAA,eAAxBA,sBAAA,CAA0BrH,eAAe,EAAE;QAC7C,IAAI,CAACgB,KAAK,CAAC4E,aAAa,CAAC5F,eAAe,CAAC6H,GAAG,CAAC;UAC3C;UACApF,GAAG,EAAE0C,OAAiB;UACtB;UACAlD,IAAI,EAAEwE,QAAS;UACf;UACAC,iBAAiB,EAAEA;QACrB,CAAC,CAAC;MACJ;IACF;IAEA/B,kBAAkBA,CAAA,EAAG;MACnB,MAAMoD,cAAmC,GACvChH,+BAA+B,CAAC,IAAI,CAACC,KAAK,CAAC;MAC7C,MAAMgH,UAAU,GAAG3G,qBAAqB,CACtC0G,cAAc,EACd,IAAI,CAACE,YAAY,CAClB;MAED,IAAID,UAAU,EAAE;QACd,IAAI,CAAC,IAAI,CAACE,2BAA2B,EAAE;UACrC,IAAI,CAACA,2BAA2B,GAAGnJ,sBAAsB,EAAE;UAE3D,MAAM;YAAEoG,OAAO;YAAEsB,QAAQ;YAAEC,iBAAiB;YAAEC;UAAW,CAAC,GACxD,IAAI,CAACN,YAAY,EAAE;UAErB,IAAI1F,MAAM,CAACC,IAAI,CAACmH,cAAc,CAAC,CAACvG,MAAM,IAAImF,UAAU,EAAE;YACpDzI,eAAe,CAACyI,UAAU,CAAC;UAC7B;UAEA,IAAI,CAACuB,2BAA2B,CAACL,GAAG,CAAC;YACnC;YACApF,GAAG,EAAE0C,OAAiB;YACtB;YACAlD,IAAI,EAAEwE,QAAS;YACf;YACAC,iBAAiB,EAAEA;UACrB,CAAC,CAAC;QACJ;QACA,MAAMyB,uBAAuB,GAC3B,IAAI,CAACD,2BAA2B,CAACC,uBAAuB;QAE1D,MAAMC,YAAY,GAAGlJ,sBAAsB,CAACmJ,MAAM,GAC9CtF,SAAS,GACR;UAAEuF,KAAK,EAAE,IAAIC,GAAG,CAAC,CAAC,IAAI,CAAC;QAAE,CAAqB,CAAC,CAAC;;QAErD,MAAMC,eAAe,GAAGA,CAAA,KAAM;UAC5B,SAAS;;UACT,MAAM9G,MAAM,GAAGD,oBAAoB,CAACsG,cAAc,CAAC;UACnD9I,WAAW,CAACkJ,uBAAuB,EAAEzG,MAAM,EAAE0G,YAAY,CAAC;QAC5D,CAAC;QACD,IAAI,CAACH,YAAY,GAAGF,cAAc;QAClC,IAAI,IAAI,CAACU,oBAAoB,EAAE;UAC7BlK,UAAU,CAAC,IAAI,CAACkK,oBAAoB,CAAC;QACvC;QACA,IAAI,CAACA,oBAAoB,GAAG,IAAI;QAChC,IAAI9H,MAAM,CAACC,IAAI,CAACmH,cAAc,CAAC,CAACvG,MAAM,EAAE;UACtC,IAAI,CAACiH,oBAAoB,GAAGnK,WAAW,CACrCkK,eAAe,EACf7H,MAAM,CAAC+H,MAAM,CAACX,cAAc,CAAC,CAC9B;QACH;MACF;IACF;IAEA3D,kBAAkBA,CAAA,EAAG;MACnB,IAAI,IAAI,CAACqE,oBAAoB,EAAE;QAC7BlK,UAAU,CAAC,IAAI,CAACkK,oBAAoB,CAAC;MACvC;IACF;IAEAE,kBAAkBA,CAChB3C,SAAwD,EACxD;MACA,IAAI,CAACD,qBAAqB,CAACC,SAAS,CAAC;MACrC,IAAI,CAACtB,qBAAqB,EAAE;MAC5B,IAAI,CAACC,kBAAkB,EAAE;IAC3B;IAoFAiE,uBAAuBA,CACrBC,UAAyD,EAChC;MACzB,MAAM7H,KAA8B,GAAG,CAAC,CAAC;MACzC,KAAK,MAAMH,GAAG,IAAIgI,UAAU,EAAE;QAC5B,MAAM3H,KAAK,GAAG2H,UAAU,CAAChI,GAAG,CAAC;QAC7B,IAAIA,GAAG,KAAK,OAAO,EAAE;UACnB,MAAMiI,SAAS,GAAGD,UAAU,CAAC9I,KAAK;UAClC,MAAMF,MAAM,GAAGL,YAAY,CAAasJ,SAAS,IAAI,EAAE,CAAC;UACxD,MAAMC,cAA0B,GAAGlJ,MAAM,CAAC8B,GAAG,CAAE5B,KAAK,IAAK;YACvD,IAAIA,KAAK,IAAIA,KAAK,CAACC,eAAe,EAAE;cAClC;cACAD,KAAK,CAACK,QAAQ,CAACyH,GAAG,CAAC,IAAI,CAAC;cACxB,IAAI,IAAI,CAACmB,cAAc,EAAE;gBACvB,IAAI,CAACC,YAAY,GAAG;kBAClB,GAAGlJ,KAAK,CAAC+H,OAAO,CAAC5G,KAAK;kBACtB,GAAG,IAAI,CAAC+H,YAAY;kBACpB,GAAGrK,iBAAiB,CAAamB,KAAK,CAAC+H,OAAO,CAACoB,OAAO;gBACxD,CAAC;cACH;cACA,OAAO,IAAI,CAACD,YAAY;YAC1B,CAAC,MAAM,IAAIvI,eAAe,CAACX,KAAK,CAAC,EAAE;cACjC,IAAI,IAAI,CAACiJ,cAAc,EAAE;gBACvB,OAAOvH,oBAAoB,CAAC1B,KAAK,CAAC;cACpC;cACA,MAAMoJ,QAAoB,GAAG,CAAC,CAAC;cAC/B,KAAK,MAAM,CAACtI,GAAG,EAAEC,UAAU,CAAC,IAAIH,MAAM,CAACS,OAAO,CAACrB,KAAK,CAAC,EAAE;gBACrD,IACE,CAACZ,aAAa,CAAC2B,UAAU,CAAC,IAC1B,EAAED,GAAG,KAAK,WAAW,IAAIP,sBAAsB,CAACQ,UAAU,CAAC,CAAC,EAC5D;kBACAqI,QAAQ,CAACtI,GAAG,CAAC,GAAGC,UAAU;gBAC5B;cACF;cACA,OAAOqI,QAAQ;YACjB,CAAC,MAAM;cACL,OAAOpJ,KAAK;YACd;UACF,CAAC,CAAC;UACFiB,KAAK,CAACH,GAAG,CAAC,GAAG/C,UAAU,CAACsL,OAAO,CAACL,cAAc,CAAC;QACjD,CAAC,MAAM,IAAIlI,GAAG,KAAK,eAAe,EAAE;UAClC,MAAMwI,YAAY,GAAGR,UAAU,CAACjD,aAE/B;UACD,IAAIyD,YAAY,CAACvB,OAAO,KAAK/E,SAAS,EAAE;YACtCpC,MAAM,CAACC,IAAI,CAACyI,YAAY,CAACvB,OAAO,CAAC5G,KAAK,CAAC,CAACC,OAAO,CAAEN,GAAG,IAAK;cAAA,IAAAyI,qBAAA,EAAAC,qBAAA;cACvDvI,KAAK,CAACH,GAAG,CAAC,IAAAyI,qBAAA,GAAGD,YAAY,CAACvB,OAAO,cAAAwB,qBAAA,uBAApBA,qBAAA,CAAsBpI,KAAK,CAACL,GAAG,CAAC;cAC7C,CAAA0I,qBAAA,GAAAF,YAAY,CAACjJ,QAAQ,cAAAmJ,qBAAA,uBAArBA,qBAAA,CAAuB1B,GAAG,CAAC,IAAI,CAAC;YAClC,CAAC,CAAC;UACJ;QACF,CAAC,MAAM,IACLpI,GAAG,CAAC,SAAS,EAAEyB,KAAK,CAAC,IACrBA,KAAK,CAACmE,OAAO,YAAYtH,mBAAmB,EAC5C;UACA,IAAImD,KAAK,CAACmE,OAAO,CAACmE,UAAU,CAAChI,MAAM,GAAG,CAAC,EAAE;YACvCN,KAAK,CAACmE,OAAO,CAACmE,UAAU,CAACrI,OAAO,CAAEsI,SAAS,IAAK;cAC9CzI,KAAK,CAACyI,SAAS,CAAC,GAAGhK,GAAG,CAAC,WAAW,EAAEyB,KAAK,CAACmE,OAAO,CAAC,GAC7CnE,KAAK,CAACmE,OAAO,CAACqE,SAAS,CACtBD,SAAS,CACV,GACD9J,aAAa;YACnB,CAAC,CAAC;UACJ,CAAC,MAAM;YACLqB,KAAK,CAACH,GAAG,CAAC,GAAGlB,aAAa;UAC5B;QACF,CAAC,MAAM,IAAIR,aAAa,CAAC+B,KAAK,CAAC,EAAE;UAC/B,IAAI,IAAI,CAAC8H,cAAc,EAAE;YACvBhI,KAAK,CAACH,GAAG,CAAC,GAAIK,KAAK,CAAsBA,KAAK;UAChD;QACF,CAAC,MAAM,IACLL,GAAG,KAAK,6BAA6B,IACrC,CAACpC,gBAAgB,EAAE,EACnB;UACAuC,KAAK,CAACH,GAAG,CAAC,GAAGK,KAAK;QACpB;MACF;MACA,OAAOF,KAAK;IACd;IAEA2I,MAAMA,CAAA,EAAG;MACP,MAAM3I,KAAK,GAAG,IAAI,CAAC4H,uBAAuB,CAAC,IAAI,CAAC5H,KAAK,CAAC;MACtD,IAAIxC,MAAM,EAAE,EAAE;QACZwC,KAAK,CAAC6C,aAAa,GAAG,IAAI,CAACA,aAAa;MAC1C;MAEA,IAAI,IAAI,CAACmF,cAAc,EAAE;QACvB,IAAI,CAACA,cAAc,GAAG,KAAK;MAC7B;MAEA,MAAMY,aAAa,GAAG/L,QAAQ,CAACgM,MAAM,CAAC;QACpCC,GAAG,EAAE,CAAC,CAAC;QACPC,OAAO,EAAE;UAAEC,WAAW,EAAE;QAAM;MAChC,CAAC,CAAC;MAEF,oBACErM,KAAA,CAAAsM,aAAA,CAACpI,SAAS,EAAAqI,QAAA,KACJlJ,KAAK;QACT;QACA;QACAwB,GAAG,EAAE,IAAI,CAAC2H;MAA6C,GACnDP,aAAa,EACjB;IAEN;EACF;EAACxH,eAAA,CA1gBKF,iBAAiB;EA4gBvBA,iBAAiB,CAACc,WAAW,GAAI,qBAC/BnB,SAAS,CAACmB,WAAW,IAAInB,SAAS,CAACI,IAAI,IAAI,WAC5C,GAAE;EAEH,oBAAOtE,KAAK,CAACyM,UAAU,CAAY,CAACpJ,KAAK,EAAEwB,GAAG,KAAK;IACjD,oBACE7E,KAAA,CAAAsM,aAAA,CAAC/H,iBAAiB,EAAAgI,QAAA,KACZlJ,KAAK,EACJwB,GAAG,KAAK,IAAI,GAAG,IAAI,GAAG;MAAEF,YAAY,EAAEE;IAAI,CAAC,EAChD;EAEN,CAAC,CAAC;AACJ"}